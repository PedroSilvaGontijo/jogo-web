<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <title>Quiz Multiplayer</title>
</head>
<body>
    <h1>Quiz Multiplayer</h1>
    <div id="playerInputContainer">
        <input type="text" id="playerInput" placeholder="Digite seu nome">
        <button id="joinButton">Entrar no Jogo</button>
    </div>
    <div id="quizContainer" style="display:none;">
        <h2 id="question"></h2>
        <div id="options"></div>
        <button id="nextButton" style="display:none;">Próxima Pergunta</button>
    </div>
    <div id="scores"></div>

    <script src="/socket.io/socket.io.js"></script>
    <script>
        const socket = io();

        const playerInput = document.getElementById('playerInput');
        const joinButton = document.getElementById('joinButton');
        const quizContainer = document.getElementById('quizContainer');
        const questionElement = document.getElementById('question');
        const optionsElement = document.getElementById('options');
        const nextButton = document.getElementById('nextButton');
        const scoresElement = document.getElementById('scores');

        let room = 'default'; // Defina um nome de sala padrão ou ajuste conforme necessário
        let playerName;

        joinButton.addEventListener('click', () => {
            playerName = playerInput.value;
            if (playerName) {
                socket.emit('joinRoom', room, playerName);
                document.getElementById('playerInputContainer').style.display = 'none';
                quizContainer.style.display = 'block';
            }
        });

        socket.on('playerJoined', (name) => {
            scoresElement.innerHTML += `<p>${name} entrou na sala!</p>`;
        });

        socket.on('updateScores', (scores) => {
            scoresElement.innerHTML = '<h3>Pontuações:</h3>';
            for (const [name, score] of Object.entries(scores)) {
                scoresElement.innerHTML += `<p>${name}: ${score}</p>`;
            }
        });

        socket.on('newQuestion', (question) => {
            questionElement.textContent = question.question;
            optionsElement.innerHTML = ''; // Limpa as opções anteriores
            question.options.forEach(option => {
                const button = document.createElement('button');
                button.textContent = option;
                button.addEventListener('click', () => {
                    socket.emit('answer', room, playerName, option);
                    optionsElement.childNodes.forEach(btn => btn.disabled = true); // Desabilita todos os botões
                });
                optionsElement.appendChild(button);
            });
            nextButton.style.display = 'none'; // Esconde o botão de próxima pergunta
        });

        socket.on('questionAnswered', () => {
            nextButton.style.display = 'block'; // Mostra o botão de próxima pergunta
        });

        nextButton.addEventListener('click', () => {
            socket.emit('nextQuestion', room);
            nextButton.style.display = 'none'; // Esconde o botão de próxima pergunta
        });

        socket.on('endQuiz', (champion) => {
            quizContainer.style.display = 'none';
            if (champion) {
                scoresElement.innerHTML = `<h2>O campeão é: ${champion}!</h2>`;
            } else {
                scoresElement.innerHTML = `<h2>O quiz terminou!</h2>`;
            }
        });
    </script>
</body>
</html>
